{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { of, take } from 'rxjs';\nimport { addIgracToZamene, addKupljeniIgracURoster, buyIgrac, removeIgracIzTransferLista, updateIgraciTransferLista } from 'src/app/store/igrac.action';\nimport { selectIgraciTransferLista, selectIgraciZamena, selectTrenutniKorisnik } from 'src/app/store/igrac.selector';\nexport let TransferiComponent = class TransferiComponent {\n  constructor(store, Sprivate, fudbalskiTimService, korisnikService) {\n    this.store = store;\n    this.korisnikService = korisnikService;\n    this.igraciTransferLista = [];\n    this.igraciZamena$ = of([]);\n    this.trenutniKorisnik$ = this.store.select(selectTrenutniKorisnik);\n    this.igraciTransferLista$ = this.store.select(selectIgraciTransferLista);\n    this.igraciZamena$ = this.store.select(selectIgraciZamena);\n    this.trenutniTimID = 1;\n  }\n  ngOnInit() {\n    this.trenutniKorisnikID = 1;\n    // OVO POPRAVI AKO STIGNES.\n    this.fudbalskiTimService.getIgraciTransferLista().subscribe(data => {\n      this.igraciTransferLista = data;\n    }),\n    // this.store.dispatch(loadIgraciZamena({ timID: this.trenutniTimID }));\n    // this.store.select(selectKorisnikIdZaBrisanje).subscribe(igracId => {\n    //   if (igracId) {\n    //     console.log(\"Igrac ID: \" + igracId)\n    //     this.igraciTransferLista = this.igraciTransferLista.filter(igrac => igrac.id !== igracId);\n    //     console.log(this.igraciTransferLista);\n    //   }\n    // });\n    this.igraciTransferLista$.subscribe(igraci => {\n      this.igraciTransferLista = igraci;\n    });\n    // this.store.pipe(\n    //   select(fromApp.selectIgraciZamena),\n    //   filter(igraciZamena => igraciZamena.length > 0),\n    // ).subscribe(igraciZamena => {\n    //   this.igraciZamena$ = of(igraciZamena);\n    // });\n  }\n\n  kupiIgraca(igrac) {\n    this.trenutniKorisnik$.pipe(take(1)).subscribe(trenutniKorisnik => {\n      if (trenutniKorisnik?.virtuelniNovac && trenutniKorisnik.virtuelniNovac >= igrac.cena) {\n        console.log(\"SAD SMO U KUPI IGRACA. SAD CE igraciTransferLista\");\n        console.log(this.igraciTransferLista);\n        console.log(\"GOTOVA je igraciTransferLista\");\n        const noviIgraciTransferLista = this.igraciTransferLista.filter(i => i.id !== igrac.id);\n        console.log(\"sace noviigracitransferlista\");\n        console.log(noviIgraciTransferLista);\n        this.store.dispatch(buyIgrac({\n          igrac\n        }));\n        this.store.dispatch(removeIgracIzTransferLista({\n          igracId: igrac.id\n        }));\n        console.log(noviIgraciTransferLista);\n        this.store.dispatch(updateIgraciTransferLista({\n          igraci: noviIgraciTransferLista\n        }));\n        console.log(trenutniKorisnik.timId);\n        this.store.dispatch(addKupljeniIgracURoster({\n          kupljeniIgrac: igrac,\n          ciljaniTimId: trenutniKorisnik.timId\n        }));\n        this.store.dispatch(addIgracToZamene({\n          timId: trenutniKorisnik.timId,\n          igracId: igrac.id\n        }));\n      } else {\n        console.log('Nemate dovoljno novca za kupovinu.');\n      }\n    });\n  }\n};\nTransferiComponent = __decorate([Component({\n  selector: 'app-transferi',\n  templateUrl: './transferi.component.html',\n  styleUrls: ['./transferi.component.css']\n})], TransferiComponent);","map":{"version":3,"names":["Component","of","take","addIgracToZamene","addKupljeniIgracURoster","buyIgrac","removeIgracIzTransferLista","updateIgraciTransferLista","selectIgraciTransferLista","selectIgraciZamena","selectTrenutniKorisnik","TransferiComponent","constructor","store","Sprivate","fudbalskiTimService","korisnikService","igraciTransferLista","igraciZamena$","trenutniKorisnik$","select","igraciTransferLista$","trenutniTimID","ngOnInit","trenutniKorisnikID","getIgraciTransferLista","subscribe","data","igraci","kupiIgraca","igrac","pipe","trenutniKorisnik","virtuelniNovac","cena","console","log","noviIgraciTransferLista","filter","i","id","dispatch","igracId","timId","kupljeniIgrac","ciljaniTimId","__decorate","selector","templateUrl","styleUrls"],"sources":["D:\\OneDrive\\OneDrive - Faculty of Electronic Engineering\\Radna povr≈°ina\\AngularProjekat\\src\\app\\components\\transferi\\transferi.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Store, select } from '@ngrx/store';\nimport { Observable, filter, of, take } from 'rxjs';\nimport { AppState } from 'src/app/app.state';\nimport { Igrac } from 'src/app/models/igrac';\nimport { Korisnik } from 'src/app/models/korisnik';\nimport { FudbalskitimService } from 'src/app/services/fudbalskitim.service'\nimport { KorisnikService } from 'src/app/services/korisnik.service';\nimport { addIgracToZamene, addKupljeniIgracURoster, buyIgrac, loadIgraciZamena, loadTrenutniKorisnik, removeIgracIzTransferLista, updateIgraciTransferLista } from 'src/app/store/igrac.action';\nimport { selectIgraciTransferLista, selectIgraciZamena, selectKorisnikIdZaBrisanje, selectTrenutniKorisnik } from 'src/app/store/igrac.selector';\nimport * as fromApp from 'src/app/store/igrac.selector';\n@Component({\n  selector: 'app-transferi',\n  templateUrl: './transferi.component.html',\n  styleUrls: ['./transferi.component.css']\n})\nexport class TransferiComponent implements OnInit {\n  igraciTransferLista: any[] = [];\n  trenutniKorisnikID: number | undefined;\n  trenutniKorisnik$: Observable<Korisnik>;\n  igraciTransferLista$: Observable<Igrac[]>;\n  igraciZamena$: Observable<Igrac[]> = of([]);\n  trenutniTimID:number; // hardcoded\n  \n\n  constructor(private store: Store<AppState>, Sprivate fudbalskiTimService: Fudbalskitimervice, private korisnikService: KorisnikService) {\n    this.trenutniKorisnik$ = this.store.select(selectTrenutniKorisnik);\n    this.igraciTransferLista$ = this.store.select(selectIgraciTransferLista);\n    this.igraciZamena$ = this.store.select(selectIgraciZamena);\n    this.trenutniTimID = 1;\n  }\n  \n  ngOnInit() {\n    this.trenutniKorisnikID = 1;\n    \n    // OVO POPRAVI AKO STIGNES.\n    this.fudbalskiTimService.getIgraciTransferLista().subscribe(data => {\n      this.igraciTransferLista = data;\n    }),\n\n    // this.store.dispatch(loadIgraciZamena({ timID: this.trenutniTimID }));\n    // this.store.select(selectKorisnikIdZaBrisanje).subscribe(igracId => {\n    //   if (igracId) {\n    //     console.log(\"Igrac ID: \" + igracId)\n    //     this.igraciTransferLista = this.igraciTransferLista.filter(igrac => igrac.id !== igracId);\n    //     console.log(this.igraciTransferLista);\n    //   }\n    // });\n    this.igraciTransferLista$.subscribe(igraci => {\n      this.igraciTransferLista = igraci;\n    });\n    \n\n    // this.store.pipe(\n    //   select(fromApp.selectIgraciZamena),\n    //   filter(igraciZamena => igraciZamena.length > 0),\n    // ).subscribe(igraciZamena => {\n    //   this.igraciZamena$ = of(igraciZamena);\n    // });\n  }\n\n\n\n  kupiIgraca(igrac: any) {\n    this.trenutniKorisnik$.pipe(\n      take(1)\n    ).subscribe(trenutniKorisnik => {\n \n      if (trenutniKorisnik?.virtuelniNovac && trenutniKorisnik.virtuelniNovac >= igrac.cena) {\n        console.log(\"SAD SMO U KUPI IGRACA. SAD CE igraciTransferLista\")\n        console.log(this.igraciTransferLista);\n        console.log(\"GOTOVA je igraciTransferLista\")\n        const noviIgraciTransferLista = this.igraciTransferLista.filter(i => i.id !== igrac.id);\n        console.log(\"sace noviigracitransferlista\")\n        console.log(noviIgraciTransferLista);\n        this.store.dispatch(buyIgrac({ igrac }));\n        this.store.dispatch(removeIgracIzTransferLista({ igracId: igrac.id }));\n        console.log(noviIgraciTransferLista);\n        this.store.dispatch(updateIgraciTransferLista({igraci:noviIgraciTransferLista}))\n        console.log(trenutniKorisnik.timId);\n        this.store.dispatch(addKupljeniIgracURoster({ kupljeniIgrac: igrac, ciljaniTimId: trenutniKorisnik.timId }));\n        this.store.dispatch(addIgracToZamene({ timId: trenutniKorisnik.timId, igracId: igrac.id }));\n       \n      } else {\n        console.log('Nemate dovoljno novca za kupovinu.');\n      }\n    });\n  }\n  \n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}